{
    "$jsonSchema": {
        "bsonType": "object",
        "required": ["logId","campaignRef","audience","messages","createdAt"],
        "properties": {
            "logId": { "bsonType": "string" },
            "campaignRef": { "bsonType": "string" },
            "audience": { "bsonType": "string" },

            "messages": {
            "bsonType": "array",
            "minItems": 1,
            "items": {
                "bsonType": "object",
                "required": ["ts","text","role"],
                "properties": {
                "ts": { "bsonType": "date" },
                "text": { "bsonType": "string" },
                "role": { "bsonType": "string", "enum": ["system","assistant","user"] }
                }
            }
            },

            "messageCount": { "bsonType": ["int","null"] },
            "lastMessageTs": { "bsonType": ["date","null"] },

            "metaJson": { "bsonType": ["string","null"] },

            "createdAt": { "bsonType": "date" }
        }
    }
}
