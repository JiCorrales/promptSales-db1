{
  "promptContent": {
    "collections": {
      "MCPClients": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "clientKey",
              "serverKey",
              "tools",
              "createdAt"
            ],
            "properties": {
              "clientKey": {
                "bsonType": "string"
              },
              "serverKey": {
                "bsonType": "string"
              },
              "tools": {
                "bsonType": "array",
                "items": {
                  "bsonType": "object",
                  "required": [
                    "tool",
                    "defaultParams"
                  ],
                  "properties": {
                    "tool": {
                      "bsonType": "string",
                      "enum": [
                        "getContent",
                        "generateCampaignMessages"
                      ]
                    },
                    "defaultParams": {
                      "bsonType": "object"
                    }
                  }
                }
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "clientKey": 1
            },
            "name": "ux_mcp_clientKey",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "serverKey": 1
            },
            "name": "ix_mcp_serverKey"
          }
        ]
      },
      "__tmp": {
        "validator": {},
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          }
        ]
      },
      "ExternalCallLogs": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "logId",
              "serviceKey",
              "timestamp",
              "statusCode",
              "method",
              "endpointKey"
            ],
            "properties": {
              "logId": {
                "bsonType": "string"
              },
              "serviceKey": {
                "bsonType": "string"
              },
              "endpointKey": {
                "bsonType": "string"
              },
              "variantKey": {
                "bsonType": [
                  "string",
                  "null"
                ]
              },
              "method": {
                "bsonType": "string",
                "enum": [
                  "GET",
                  "POST",
                  "PUT",
                  "PATCH",
                  "DELETE"
                ]
              },
              "request": {
                "bsonType": "object",
                "properties": {
                  "headers": {
                    "bsonType": [
                      "object",
                      "null"
                    ],
                    "description": "sin datos sensibles"
                  },
                  "body": {
                    "bsonType": [
                      "object",
                      "string",
                      "null"
                    ]
                  },
                  "query": {
                    "bsonType": [
                      "object",
                      "null"
                    ]
                  }
                }
              },
              "response": {
                "bsonType": "object",
                "properties": {
                  "headers": {
                    "bsonType": [
                      "object",
                      "null"
                    ]
                  },
                  "body": {
                    "bsonType": [
                      "object",
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "statusCode": {
                "bsonType": "int"
              },
              "statusText": {
                "bsonType": [
                  "string",
                  "null"
                ]
              },
              "durationMS": {
                "bsonType": [
                  "int",
                  "null"
                ]
              },
              "app": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "name": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "version": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "process": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "client": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "userId": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "platform": {
                    "bsonType": [
                      "string",
                      "null"
                    ],
                    "enum": [
                      "promptcontent",
                      "promptads",
                      "promptcrm",
                      "web"
                    ]
                  },
                  "userAgent": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "ipHash": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "timestamp": {
                "bsonType": "date"
              },
              "processedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              },
              "error": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "code": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "message": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "stack": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "traceId": {
                "bsonType": [
                  "string",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "serviceKey": 1,
              "endpointKey": 1,
              "timestamp": -1
            },
            "name": "ix_apicall_service_endpoint_time"
          },
          {
            "v": 2,
            "key": {
              "statusCode": 1,
              "timestamp": 1
            },
            "name": "ix_apicall_status_time"
          },
          {
            "v": 2,
            "key": {
              "client.userId": 1,
              "timestamp": -1
            },
            "name": "ix_apicall_user_time"
          },
          {
            "v": 2,
            "key": {
              "traceId": 1
            },
            "name": "ix_apicall_trace",
            "sparse": true
          }
        ]
      },
      "GeneratedContent": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "contentId",
              "type",
              "dataRef",
              "description",
              "lang",
              "createdAt"
            ],
            "properties": {
              "contentId": {
                "bsonType": "string"
              },
              "type": {
                "bsonType": "string",
                "enum": [
                  "text",
                  "image",
                  "video",
                  "audio",
                  "script"
                ]
              },
              "title": {
                "bsonType": [
                  "string",
                  "null"
                ]
              },
              "description": {
                "bsonType": "string"
              },
              "hashtags": {
                "bsonType": [
                  "array",
                  "null"
                ],
                "items": {
                  "bsonType": "string",
                  "pattern": "^#\\w+"
                }
              },
              "lang": {
                "bsonType": "string",
                "description": "ISO-639-1"
              },
              "dataRef": {
                "bsonType": "object",
                "required": [
                  "kind"
                ],
                "properties": {
                  "kind": {
                    "bsonType": "string",
                    "enum": [
                      "blob",
                      "url",
                      "s3",
                      "gcs"
                    ]
                  },
                  "url": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "bucket": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "key": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "checksum": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "metadata": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "format": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "sizeKB": {
                    "bsonType": [
                      "int",
                      "long",
                      "double",
                      "null"
                    ]
                  },
                  "durationMS": {
                    "bsonType": [
                      "int",
                      "null"
                    ]
                  },
                  "resolution": {
                    "bsonType": [
                      "object",
                      "null"
                    ],
                    "properties": {
                      "width": {
                        "bsonType": [
                          "int",
                          "null"
                        ]
                      },
                      "height": {
                        "bsonType": [
                          "int",
                          "null"
                        ]
                      },
                      "aspectRatio": {
                        "bsonType": [
                          "string",
                          "null"
                        ]
                      }
                    }
                  }
                }
              },
              "trace": {
                "bsonType": "object",
                "properties": {
                  "source": {
                    "bsonType": "string",
                    "enum": [
                      "AI",
                      "API",
                      "Manual",
                      "External"
                    ]
                  },
                  "aiRequestId": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "aiResponseId": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "modelProvider": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "modelName": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "modelVersion": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "vector": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "provider": {
                    "bsonType": [
                      "string",
                      "null"
                    ],
                    "description": "pinecone|faiss|pgvector|atlas"
                  },
                  "vectorId": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "dim": {
                    "bsonType": [
                      "int",
                      "null"
                    ]
                  }
                }
              },
              "usage": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "campaignRefs": {
                    "bsonType": [
                      "array",
                      "null"
                    ],
                    "items": {
                      "bsonType": "string"
                    }
                  },
                  "firstUsedAt": {
                    "bsonType": [
                      "date",
                      "null"
                    ]
                  },
                  "lastUsedAt": {
                    "bsonType": [
                      "date",
                      "null"
                    ]
                  }
                }
              },
              "deliverTo": {
                "bsonType": [
                  "array",
                  "null"
                ],
                "description": "Destino lógico del asset",
                "items": {
                  "bsonType": "object",
                  "required": [
                    "type",
                    "refId"
                  ],
                  "properties": {
                    "type": {
                      "bsonType": "string",
                      "enum": [
                        "campaign",
                        "ad",
                        "strategy",
                        "client"
                      ]
                    },
                    "refId": {
                      "bsonType": "string"
                    },
                    "notes": {
                      "bsonType": [
                        "string",
                        "null"
                      ]
                    }
                  }
                }
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              },
              "status": {
                "bsonType": "string",
                "enum": [
                  "draft",
                  "approved",
                  "archived"
                ]
              },
              "rights": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "license": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "owner": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "expirationDate": {
                    "bsonType": [
                      "date",
                      "null"
                    ]
                  },
                  "requiresAttribution": {
                    "bsonType": [
                      "bool",
                      "null"
                    ]
                  }
                }
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "contentId": 1
            },
            "name": "ux_generatedcontent_contentId",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "_fts": "text",
              "_ftsx": 1
            },
            "name": "tx_gc_desc_title",
            "weights": {
              "description": 1,
              "title": 1
            },
            "default_language": "english",
            "language_override": "language",
            "textIndexVersion": 3
          },
          {
            "v": 2,
            "key": {
              "hashtags": 1
            },
            "name": "ix_gc_hashtags"
          },
          {
            "v": 2,
            "key": {
              "vector.vectorId": 1
            },
            "name": "ix_gc_vectorId"
          }
        ]
      },
      "CampaingLogs": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "logId",
              "campaignRef",
              "audience",
              "messages",
              "createdAt"
            ],
            "properties": {
              "logId": {
                "bsonType": "string"
              },
              "campaignRef": {
                "bsonType": "string"
              },
              "audience": {
                "bsonType": "string"
              },
              "messages": {
                "bsonType": "array",
                "minItems": 1,
                "items": {
                  "bsonType": "object",
                  "required": [
                    "ts",
                    "text",
                    "role"
                  ],
                  "properties": {
                    "ts": {
                      "bsonType": "date"
                    },
                    "text": {
                      "bsonType": "string"
                    },
                    "role": {
                      "bsonType": "string",
                      "enum": [
                        "system",
                        "assistant",
                        "user"
                      ]
                    }
                  }
                }
              },
              "meta": {
                "bsonType": [
                  "object",
                  "null"
                ]
              },
              "createdAt": {
                "bsonType": "date"
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "campaignRef": 1
            },
            "name": "ix_cpl_campaign"
          },
          {
            "v": 2,
            "key": {
              "audience": 1,
              "messages.ts": -1
            },
            "name": "audience_1_messages.ts_-1"
          }
        ]
      },
      "AIRequests": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "aiRequestId",
              "createdAt",
              "status",
              "prompt",
              "context"
            ],
            "properties": {
              "aiRequestId": {
                "bsonType": "string"
              },
              "createdAt": {
                "bsonType": "date"
              },
              "completedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              },
              "status": {
                "bsonType": "string",
                "enum": [
                  "pending",
                  "processing",
                  "completed",
                  "failed"
                ]
              },
              "priority": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "enum": [
                  "normal",
                  "high",
                  "urgent"
                ]
              },
              "prompt": {
                "bsonType": "string"
              },
              "context": {
                "bsonType": "object",
                "required": [
                  "type",
                  "language"
                ],
                "properties": {
                  "type": {
                    "bsonType": "string",
                    "enum": [
                      "image",
                      "video",
                      "text",
                      "audio",
                      "script"
                    ]
                  },
                  "language": {
                    "bsonType": "string"
                  },
                  "contentRef": {
                    "bsonType": [
                      "string",
                      "null"
                    ],
                    "description": "Para edición de contenido existente"
                  },
                  "campaignRef": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "segmentKey": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "parameters": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "size": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "durationMS": {
                    "bsonType": [
                      "int",
                      "null"
                    ]
                  },
                  "style": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "voice": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "animation": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "temperature": {
                    "bsonType": [
                      "double",
                      "null"
                    ]
                  },
                  "maxTokens": {
                    "bsonType": [
                      "int",
                      "null"
                    ]
                  }
                }
              },
              "model": {
                "bsonType": "object",
                "properties": {
                  "provider": {
                    "bsonType": [
                      "string",
                      "null"
                    ],
                    "description": "openai|anthropic|stability|...|internal"
                  },
                  "name": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "version": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "mcp": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "serverKey": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "clientKey": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "tool": {
                    "bsonType": [
                      "string",
                      "null"
                    ],
                    "enum": [
                      "getContent",
                      "generateCampaignMessages"
                    ]
                  }
                }
              },
              "requestBody": {
                "bsonType": [
                  "object",
                  "string"
                ],
                "description": "Cuerpo exacto enviado (auditoría)"
              },
              "requestHeaders": {
                "bsonType": [
                  "object",
                  "null"
                ]
              },
              "responseRef": {
                "bsonType": [
                  "string",
                  "null"
                ]
              },
              "error": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "code": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "message": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "details": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "requestedBy": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "userId": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "platform": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "aiRequestId": 1
            },
            "name": "ux_airequests_aiRequestId",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "status": 1,
              "createdAt": -1
            },
            "name": "ix_airequests_status_created"
          }
        ]
      },
      "FineTunedModels": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "fineTuneId",
              "baseProviderKey",
              "baseModelName",
              "createdAt"
            ],
            "properties": {
              "fineTuneId": {
                "bsonType": "string",
                "description": "ID interno del fine-tune"
              },
              "baseProviderKey": {
                "bsonType": "string",
                "description": "Ej. openai, anthropic, stability"
              },
              "baseModelName": {
                "bsonType": "string",
                "description": "Ej. gpt-4o, claude-3.7-sonnet, stable-image-3"
              },
              "versionTag": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "description": "Etiqueta humana ej. v1, 2025-10"
              },
              "trainingRef": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "description": "Dónde está el dataset/artefacto (ID o URL interna)"
              },
              "hosting": {
                "bsonType": "object",
                "required": [
                  "providerKey",
                  "modelName"
                ],
                "properties": {
                  "providerKey": {
                    "bsonType": "string",
                    "description": "Dónde se sirve (p.ej. openai)"
                  },
                  "modelName": {
                    "bsonType": "string",
                    "description": "Nombre invocable del modelo ya fine-tuned"
                  },
                  "endpointAlias": {
                    "bsonType": [
                      "string",
                      "null"
                    ],
                    "description": "Coincide con ExternalServices.serviceKey si aplica"
                  }
                }
              },
              "notes": {
                "bsonType": [
                  "string",
                  "null"
                ]
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              },
              "status": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "enum": [
                  "draft",
                  "active",
                  "retired"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "fineTuneId": 1
            },
            "name": "ux_ftmodels_fineTuneId",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "hosting.providerKey": 1,
              "modelName": 1
            },
            "name": "ix_ftmodels_hosting_provider_model"
          },
          {
            "v": 2,
            "key": {
              "baseProviderKey": 1,
              "baseModelName": 1
            },
            "name": "ix_ftmodels_base_provider_model"
          }
        ]
      },
      "ContentPlans": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "planId",
              "name",
              "targets",
              "items",
              "createdAt"
            ],
            "properties": {
              "planId": {
                "bsonType": "string"
              },
              "name": {
                "bsonType": "string"
              },
              "campaignRef": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "description": "ID de campaña en PromptAds si aplica"
              },
              "targets": {
                "bsonType": "array",
                "minItems": 1,
                "items": {
                  "bsonType": "object",
                  "required": [
                    "segmentKey"
                  ],
                  "properties": {
                    "segmentKey": {
                      "bsonType": "string"
                    },
                    "notes": {
                      "bsonType": [
                        "string",
                        "null"
                      ]
                    }
                  }
                }
              },
              "items": {
                "bsonType": "array",
                "minItems": 1,
                "items": {
                  "bsonType": "object",
                  "required": [
                    "type",
                    "quantity"
                  ],
                  "properties": {
                    "type": {
                      "bsonType": "string",
                      "enum": [
                        "text",
                        "image",
                        "video",
                        "audio",
                        "script",
                        "carousel",
                        "story"
                      ]
                    },
                    "quantity": {
                      "bsonType": "int",
                      "minimum": 1
                    },
                    "spec": {
                      "bsonType": [
                        "object",
                        "null"
                      ],
                      "properties": {
                        "size": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "format": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "durationMS": {
                          "bsonType": [
                            "int",
                            "null"
                          ]
                        },
                        "style": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "voice": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "animation": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "constraints": {
                          "bsonType": [
                            "object",
                            "null"
                          ]
                        }
                      }
                    }
                  }
                }
              },
              "status": {
                "bsonType": "string",
                "enum": [
                  "draft",
                  "active",
                  "archived"
                ]
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "planId": 1
            },
            "name": "ux_contentplans_planId",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "campaignRef": 1
            },
            "name": "ix_contentplans_campaign"
          }
        ]
      },
      "ContentRequests": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "requestId",
              "requestedBy",
              "intent",
              "targets",
              "requestedContent",
              "createdAt"
            ],
            "properties": {
              "requestId": {
                "bsonType": "string",
                "description": "ULID/UUID"
              },
              "intent": {
                "bsonType": "string",
                "description": "Qué se busca (ej. 'anuncio meta leadgen')"
              },
              "campaignRef": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "description": "ID en PromptAds (opcional)"
              },
              "requestedBy": {
                "bsonType": "object",
                "required": [
                  "userId",
                  "platform"
                ],
                "properties": {
                  "userId": {
                    "bsonType": "string"
                  },
                  "platform": {
                    "bsonType": "string",
                    "enum": [
                      "promptcontent",
                      "promptads",
                      "promptcrm",
                      "web"
                    ]
                  },
                  "appTrace": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "targets": {
                "bsonType": "array",
                "minItems": 1,
                "items": {
                  "bsonType": "object",
                  "required": [
                    "segmentKey"
                  ],
                  "properties": {
                    "segmentKey": {
                      "bsonType": "string"
                    },
                    "conditions": {
                      "bsonType": [
                        "object",
                        "null"
                      ]
                    }
                  }
                }
              },
              "requestedContent": {
                "bsonType": "array",
                "minItems": 1,
                "items": {
                  "bsonType": "object",
                  "required": [
                    "type",
                    "quantity"
                  ],
                  "properties": {
                    "type": {
                      "bsonType": "string",
                      "enum": [
                        "text",
                        "image",
                        "video",
                        "audio",
                        "script",
                        "carousel",
                        "story"
                      ]
                    },
                    "quantity": {
                      "bsonType": "int",
                      "minimum": 1
                    },
                    "spec": {
                      "bsonType": [
                        "object",
                        "null"
                      ],
                      "properties": {
                        "size": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "durationMS": {
                          "bsonType": [
                            "int",
                            "null"
                          ]
                        },
                        "style": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "voice": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "animation": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "format": {
                          "bsonType": [
                            "string",
                            "null"
                          ]
                        },
                        "constraints": {
                          "bsonType": [
                            "object",
                            "null"
                          ]
                        }
                      }
                    }
                  }
                }
              },
              "brief": {
                "bsonType": [
                  "string",
                  "null"
                ]
              },
              "originalPayload": {
                "bsonType": [
                  "object",
                  "string",
                  "null"
                ],
                "description": "Cuerpo exacto del formulario/UI que originó la solicitud"
              },
              "status": {
                "bsonType": "string",
                "enum": [
                  "pending",
                  "processing",
                  "completed",
                  "failed"
                ]
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "requestId": 1
            },
            "name": "ux_contentrequests_requestId",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "status": 1,
              "createdAt": -1
            },
            "name": "ix_contentrequests_status_created"
          }
        ]
      },
      "ExternalServices": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "serviceKey",
              "name",
              "authType",
              "createdAt"
            ],
            "properties": {
              "serviceKey": {
                "bsonType": "string",
                "description": "Clave interna (no PII/no secretos)"
              },
              "name": {
                "bsonType": "string"
              },
              "authType": {
                "bsonType": "string",
                "enum": [
                  "OAuth2",
                  "API_KEY",
                  "Bearer",
                  "Basic",
                  "Custom"
                ]
              },
              "vaultRef": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "description": "Ruta/ID en el vault/keystore que guarda secretos reales"
              },
              "status": {
                "bsonType": "string",
                "enum": [
                  "active",
                  "inactive",
                  "testing"
                ]
              },
              "lastTestedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              },
              "configTemplates": {
                "bsonType": [
                  "array",
                  "null"
                ],
                "items": {
                  "bsonType": "object",
                  "required": [
                    "endpointKey",
                    "method"
                  ],
                  "properties": {
                    "endpointKey": {
                      "bsonType": "string",
                      "description": "Alias del endpoint (NO URL directa)"
                    },
                    "method": {
                      "bsonType": "string",
                      "enum": [
                        "GET",
                        "POST",
                        "PUT",
                        "PATCH",
                        "DELETE"
                      ]
                    },
                    "headersTemplate": {
                      "bsonType": [
                        "object",
                        "null"
                      ],
                      "description": "Objetos con placeholders ej. {\"Authorization\":\"Bearer {{token}}\"}"
                    },
                    "bodyTemplate": {
                      "bsonType": [
                        "object",
                        "null"
                      ],
                      "description": "Plantilla JSON para POST/PUT/PATCH con placeholders"
                    },
                    "queryTemplate": {
                      "bsonType": [
                        "object",
                        "null"
                      ],
                      "description": "Querystring dinámico con placeholders"
                    }
                  }
                },
                "description": "Definiciones abstractas sin urls/secretos"
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "serviceKey": 1
            },
            "name": "ux_extsvc_serviceKey",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "status": 1
            },
            "name": "ix_extsvc_status"
          }
        ]
      },
      "ModelProviders": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "providerKey",
              "name",
              "createdAt"
            ],
            "properties": {
              "providerKey": {
                "bsonType": "string"
              },
              "name": {
                "bsonType": "string"
              },
              "models": {
                "bsonType": "array",
                "items": {
                  "bsonType": "object",
                  "required": [
                    "modelName",
                    "tasks"
                  ],
                  "properties": {
                    "modelName": {
                      "bsonType": "string"
                    },
                    "version": {
                      "bsonType": [
                        "string",
                        "null"
                      ]
                    },
                    "tasks": {
                      "bsonType": "array",
                      "items": {
                        "bsonType": "string"
                      }
                    },
                    "defaultParams": {
                      "bsonType": [
                        "object",
                        "null"
                      ],
                      "properties": {
                        "temperature": {
                          "bsonType": [
                            "double",
                            "null"
                          ]
                        },
                        "maxTokens": {
                          "bsonType": [
                            "int",
                            "null"
                          ]
                        }
                      }
                    }
                  }
                }
              },
              "kind": {
                "bsonType": "string",
                "enum": [
                  "external",
                  "finetuned",
                  "internal"
                ]
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "providerKey": 1
            },
            "name": "ux_modelproviders_providerKey"
          }
        ]
      },
      "Users": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "userId",
              "email",
              "name",
              "role",
              "createdAt",
              "status"
            ],
            "properties": {
              "userId": {
                "bsonType": "string"
              },
              "email": {
                "bsonType": "string"
              },
              "name": {
                "bsonType": "string"
              },
              "role": {
                "bsonType": "string",
                "enum": [
                  "admin",
                  "marketer",
                  "agent",
                  "client"
                ]
              },
              "platform": {
                "bsonType": [
                  "string",
                  "null"
                ],
                "enum": [
                  "promptcontent",
                  "promptads",
                  "promptcrm",
                  "web"
                ]
              },
              "createdAt": {
                "bsonType": "date"
              },
              "lastLogin": {
                "bsonType": [
                  "date",
                  "null"
                ]
              },
              "status": {
                "bsonType": "string",
                "enum": [
                  "active",
                  "inactive",
                  "suspended"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "userId": 1
            },
            "name": "ux_pcusers_userId",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "email": 1
            },
            "name": "ux_pcusers_email",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "status": 1,
              "role": 1
            },
            "name": "ix_pcusers_status_role"
          }
        ]
      },
      "AIResponses": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "aiResponseId",
              "aiRequestId",
              "generatedAt",
              "status"
            ],
            "properties": {
              "aiResponseId": {
                "bsonType": "string"
              },
              "aiRequestId": {
                "bsonType": "string"
              },
              "generatedAt": {
                "bsonType": "date"
              },
              "status": {
                "bsonType": "string",
                "enum": [
                  "ok",
                  "error",
                  "partial"
                ]
              },
              "latencyMS": {
                "bsonType": [
                  "int",
                  "null"
                ]
              },
              "responseBody": {
                "bsonType": [
                  "object",
                  "string"
                ]
              },
              "output": {
                "bsonType": [
                  "array",
                  "null"
                ],
                "items": {
                  "bsonType": "object",
                  "properties": {
                    "contentRef": {
                      "bsonType": [
                        "string",
                        "null"
                      ],
                      "description": "contentId en GeneratedContent"
                    },
                    "segmentKey": {
                      "bsonType": [
                        "string",
                        "null"
                      ]
                    },
                    "score": {
                      "bsonType": [
                        "double",
                        "null"
                      ]
                    }
                  }
                }
              },
              "modelEcho": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "provider": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "name": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "version": {
                    "bsonType": [
                      "string",
                      "null"
                    ]
                  },
                  "tokenUsage": {
                    "bsonType": [
                      "object",
                      "null"
                    ],
                    "properties": {
                      "input": {
                        "bsonType": [
                          "int",
                          "null"
                        ]
                      },
                      "output": {
                        "bsonType": [
                          "int",
                          "null"
                        ]
                      },
                      "total": {
                        "bsonType": [
                          "int",
                          "null"
                        ]
                      }
                    }
                  }
                }
              },
              "error": {
                "bsonType": [
                  "object",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "aiReponseId": 1
            },
            "name": "ux_airesponses_aiResponseId",
            "unique": true
          },
          {
            "v": 2,
            "key": {
              "aiRequestId": 1,
              "generatedAt": -1
            },
            "name": "ix_airesponses_req_time"
          }
        ]
      },
      "MCPServers": {
        "validator": {
          "$jsonSchema": {
            "bsonType": "object",
            "required": [
              "serverKey",
              "name",
              "tools",
              "createdAt"
            ],
            "properties": {
              "serverKey": {
                "bsonType": "string"
              },
              "name": {
                "bsonType": "string"
              },
              "tools": {
                "bsonType": "array",
                "minItems": 1,
                "items": {
                  "bsonType": "object",
                  "required": [
                    "toolName",
                    "paramsSchema"
                  ],
                  "properties": {
                    "toolName": {
                      "bsonType": "string",
                      "enum": [
                        "getContent",
                        "generateCampaignMessages"
                      ]
                    },
                    "paramsSchema": {
                      "bsonType": "object"
                    },
                    "timeoutMS": {
                      "bsonType": [
                        "int",
                        "null"
                      ]
                    }
                  }
                }
              },
              "clientDefaults": {
                "bsonType": [
                  "object",
                  "null"
                ],
                "properties": {
                  "retry": {
                    "bsonType": [
                      "int",
                      "null"
                    ]
                  },
                  "backoff": {
                    "bsonType": [
                      "int",
                      "null"
                    ]
                  }
                }
              },
              "createdAt": {
                "bsonType": "date"
              },
              "updatedAt": {
                "bsonType": [
                  "date",
                  "null"
                ]
              }
            }
          }
        },
        "indexes": [
          {
            "v": 2,
            "key": {
              "_id": 1
            },
            "name": "_id_"
          },
          {
            "v": 2,
            "key": {
              "serverKey": 1
            },
            "name": "ux_mcp_serverKey",
            "unique": true
          }
        ]
      }
    }
  }
}
