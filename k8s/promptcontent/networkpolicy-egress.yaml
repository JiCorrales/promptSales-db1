apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: promptcontent-egress-restricted
  namespace: promptcontent-dev
  labels:
    app: promptcontent
spec:
  podSelector:
    matchLabels:
      app: promptcontent
  policyTypes:
    - Egress
  egress:
    # DNS
    - to:
        - namespaceSelector:
            matchLabels:
              name: kube-system
      ports:
        - protocol: UDP
          port: 53
    # PostgreSQL (PromptSales central)
    - to:
        - namespaceSelector:
            matchLabels:
              component: central
      ports:
        - protocol: TCP
          port: 5432
    # MongoDB (PromptContent)
    - to:
        - namespaceSelector:
            matchLabels:
              component: content
      ports:
        - protocol: TCP
          port: 27017
    # Redis cache (si se usa desde PromptContent)
    - to:
        - namespaceSelector:
            matchLabels:
              component: cache
      ports:
        - protocol: TCP
          port: 6379
